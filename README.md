# Домашнее задание к занятию «Защита сети»

### ` Дмитрий Климов `

## Задание 1

Проведите разведку системы и определите, какие сетевые службы запущены на защищаемой системе:

sudo nmap -sA < ip-адрес >

sudo nmap -sT < ip-адрес >

sudo nmap -sS < ip-адрес >

sudo nmap -sV < ip-адрес >

По желанию можете поэкспериментировать с опциями: https://nmap.org/man/ru/man-briefoptions.html.

В качестве ответа пришлите события, которые попали в логи Suricata и Fail2Ban, прокомментируйте результат.

## Ответ:

<img width="1920" height="1080" alt="Снимок экрана (1235)" src="https://github.com/Agooll007/Avetisov_13_03_hw/blob/main/img/2026-02-09_20-10-52.png" />

<img width="1920" height="1080" alt="Снимок экрана (1237)" src="https://github.com/Agooll007/Avetisov_13_03_hw/blob/main/img/2026-02-09_20-11-18.png" />


## Комментарий:

В рамках задания была выполнена атака подбора пароля к службе SSH с использованием утилиты Hydra и словарей пользователей и паролей.

Hydra осуществляла множественные попытки аутентификации по протоколу SSH, что привело к серии неудачных входов.

В логах Fail2Ban были зафиксированы события типа Found <IP> и последующая запись Ban <IP>, что свидетельствует об автоматической блокировке IP-адреса атакующей системы после превышения допустимого числа неудачных попыток входа.

Одновременно Suricata зарегистрировала сетевую активность, связанную с частыми подключениями к порту 22/tcp, и сгенерировала события обнаружения сканирования/подбора паролей (например, ET SCAN Potential SSH Scan).

Таким образом, защита функционирует корректно: Suricata обнаруживает подозрительную сетевую активность, а Fail2Ban предотвращает успешную реализацию атаки, блокируя источник bruteforce.

## Примечание:

При тестировании внутреннего трафика между ВМ в одной подсети Yandex Cloud события сетевой разведки (nmap) не всегда детектируются IDS Suricata из‑за особенностей облачной сети и быстрого ответа TCP‑стека.
При этом атаки извне и попытки bruteforce корректно фиксируются системой.




## Задание 2

Проведите атаку на подбор пароля для службы SSH:

hydra -L users.txt -P pass.txt < ip-адрес > ssh

### Настройка hydra:
создайте два файла: users.txt и pass.txt;
в каждой строчке первого файла должны быть имена пользователей, второго — пароли. В нашем случае это могут быть случайные строки, но ради эксперимента можете добавить имя и пароль существующего пользователя.
Дополнительная информация по hydra: https://kali.tools/?p=1847.

### Включение защиты SSH для Fail2Ban:
открыть файл /etc/fail2ban/jail.conf,
найти секцию ssh,
установить enabled в true.
Дополнительная информация по Fail2Ban:https://putty.org.ru/articles/fail2ban-ssh.html.

В качестве ответа пришлите события, которые попали в логи Suricata и Fail2Ban, прокомментируйте результат.

## Ответ:

### `` hydra-атака ``

<img width="1920" height="1080" alt="Снимок экрана (1252)" src="https://github.com/Agooll007/Avetisov_13_03_hw/blob/main/img/2026-02-10_05-33-08.png" />

### `` логи событий Fail2Ban и Suricata ``

<img width="1920" height="1080" alt="Снимок экрана (1253)" https://github.com/Agooll007/Avetisov_13_03_hw/blob/main/img/2026-02-10_05-03-36.png" />

<img width="1920" height="1080" alt="Снимок экрана (1254)" src="https://github.com/Agooll007/Avetisov_13_03_hw/blob/main/img/2026-02-10_05-33-08.png" />


## Результаты:

В ходе выполнения задания была проведена атака подбора пароля (brute‑force) на сервис SSH с использованием инструмента Hydra с узла 10.129.0.5 на защищаемый хост 10.129.0.22.
В процессе атаки Suricata зафиксировала множественные события типа SURICATA STREAM excessive retransmissions, что указывает на большое количество быстрых TCP‑подключений к порту 22/tcp, характерных для перебора паролей. Также были зарегистрированы сигнатуры ET SCAN Potential SSH Scan, подтверждающие детектирование подозрительной активности и попыток массовых соединений с SSH.
Fail2Ban отреагировал на серию неудачных попыток аутентификации, что отражено в логах множественными записями [sshd] Found 10.129.0.5, после чего сработал механизм защиты и была применена блокировка атакующего IP‑адреса.
Таким образом, Suricata успешно обнаружила сетевые признаки brute‑force атаки, а Fail2Ban предотвратил дальнейшие попытки подбора пароля.



## Вывод:

Fail2Ban эффективно защищает от атак перебором паролей SSH.
Suricata может обнаружить контакты кабеля SSH, но для более точного обнаружения атаки при переборе паролей могут применяться более специализированные правила.
Настройка верхних инструментов (Fail2Ban и Suricata) обеспечивает многоуровневую защиту от атак. Fail2Ban блокирует IP-адреса, а Suricata предоставляет информацию о характере атаки.
